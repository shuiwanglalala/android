# 从共享存储空间访问文档和其他文件

由于用户参与选择您的应用可以访问的文件或目录，因此该机制无需任何[系统权限](https://developer.android.com/guide/topics/permissions/overview?hl=zh-cn)，同时用户控制和隐私保护也得到了增强。此外，这些文件存储在应用专属目录和媒体库之外，在应用卸载后仍会保留在设备上

## 创建新文件

使用 [`ACTION_CREATE_DOCUMENT`](https://developer.android.com/reference/android/content/Intent?hl=zh-cn#ACTION_CREATE_DOCUMENT) intent 操作加载系统文件选择器，支持用户选择要写入文件内容的位置

**注意**：`ACTION_CREATE_DOCUMENT` 无法覆盖现有文件。如果您的应用尝试保存同名文件，系统会在文件名的末尾附加一个数字并将其包含在一对括号中

在配置 intent 时，应指定文件的名称和 MIME 类型，并且还可以根据需要使用 [`EXTRA_INITIAL_URI`](https://developer.android.com/reference/android/provider/DocumentsContract?hl=zh-cn#EXTRA_INITIAL_URI) intent extra 指定文件选择器在首次加载时应显示的文件或目录的 URI

## 打开文件

## 授予对目录内容的访问权限

**注意**：本部分介绍的 intent 操作在 Android 5.0（API 级别 21）及更高版本中提供

使用 `ACTION_OPEN_DOCUMENT_TREE` 时，您的应用只能访问用户所选目录中的文件。您无权访问位于用户所选目录之外的其他应用的文件。借助这种由用户控制的访问权限，用户可以确切选择自己想要与您的应用共享的具体内容

## 在所选位置执行操作

### 保留权限

当您的应用打开文件进行读取或写入时，系统会向应用授予对该文件的 URI 的访问权限，该授权在用户重启设备之前一直有效

如需在设备重启后保留对文件的访问权限并提供更出色的用户体验，您的应用可以“获取”系统提供的永久性 URI 访问权限

### 检查文档元数据

### 打开文档

