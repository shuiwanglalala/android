# 创建内容提供程序

## 设计数据存储

### 数据设计考虑事项

表格数据应始终有“主键”列，提供程序会将其作为每行的唯一数值加以维护。您可以使用此值将某行链接到其他表中的相关行（将其用作“外键”）。尽管您可以随意命名此列，但请最好使用 `BaseColumns._ID`

如果您想提供位图图像或其他非常庞大的文件导向型数据，请将数据存储在文件中，然后间接提供这些数据，而非直接将其存储在表格中

## 实现内容提供程序权限

### 实现权限

即使底层数据为私有数据，所有应用仍可读取提供程序的数据或向其写入数据，因为您的提供程序默认未设置权限。如要更改此情况，请使用属性或 `` 元素的子元素，在清单文件中为提供程序设置权限。您可以设置适用于整个提供程序、特定表甚至特定记录的权限，或者设置同时适用于这三者的权限

相较于作用域较大的权限，越细化的权限拥有更高的优先级

**统一的读写提供程序级权限**

**单独的读写提供程序级权限**

**路径级权限**

**临时权限**

一种权限级别，即使应用没有通常需要的权限，该权限级别也能授予对应用的临时访问权限。临时访问功能可减少应用需在其清单文件中请求的权限数量

如要启用临时权限，请设置 `` 元素的 `android:grantUriPermissions` 属性，或者向您的 `` 元素添加一个或多个 `` 子元素。如果您使用临时权限，则每当从提供程序中为某个已关联临时权限的内容 URI 移除支持时，您都须调用 `Context.revokeUriPermission()`

该属性的值决定了可访问的提供程序范围。如果将该属性设置为 `true`，则系统会向整个提供程序授予临时权限，进而替换提供程序级或路径级权限所需的任何其他权限

如果将此标志设置为 `false`，则您必须向 `` 元素添加 `` 子元素。每个子元素都会指定被授予临时权限的一个或多个内容 URI

如要向应用授予临时访问权限，Intent 必须包含 `FLAG_GRANT_READ_URI_PERMISSION` 和/或 `FLAG_GRANT_WRITE_URI_PERMISSION` 标志。您需使用 `setFlags()` 方法对其进行设置

如果不存在 `android:grantUriPermissions` 属性，则假设其为 `false`