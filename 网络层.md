# 网络层

+ 数据交换方式
  + 电路交换 独占资源
    + 电路交换的过程
      + 建立连接
      + 通信
      + 释放连接
  + 报文交换
    + 报文交换的特点
      + 无需建立连接
      + 存储转发，动态分配线路
      + 多目标服务
  + 分组交换 把大的数据分割成小的数据块
    + 数据报交换 
      + 无连接服务
      + 每个分组携带源和目的地址
      + 路由器根据分组的目的地址转发分组
    + 虚电路交换 
      + 连接服务

+ 路由算法与路由协议
  + 路由算法
    + 按静态和动态分类
      + 静态路由算法
      + 动态路由算法
    + 按全局性和分散性分类
      + 全局性路由算法
        + OSPF
      + 分散性路由算法
        + RIP
  + 路由协议
    + 内部网关协议 IGP
      + RIP OSPF
    + 外部网关协议 EGP
      + BGP
+ IP数据报

+ IP地址
  + 32位，分为网络号和主机号
  + 分类，依据为前8位的取值
    + A 1-127
      + 0
    + B 128-191
      + 10
    + C 192-223
      + 110
    + D 224-239 多播地址
      + 1110
    + E 240-255 研究
      + 1111
  + 保留的私有地址 用于内网的服务器地址
    + 10.0.0.0-10.255.255.255 1
    + 172.16.0.0-172.31.255.255 16
    + 192.168.0.0-192.168.255.255 256



+ 子网掩码
  + ip地址和子网掩码做与运算，得到网络号
  + 划分子网
+ 超网合并网络
    + 判断子网是否能合并
      + 除以4，第一个余0，第二个余1，第三个余2，第四个余3，就可以
+ + 
+ 特殊的地址
  + 169.254.0.0 临时地址
  + 组播 多播 224.0.0.0-239.255.255.255
+ 网络层提供两种服务
  + 虚电路服务
  + 数据报服务
    + 无连接的、尽最大努力交付。发送分组时不需要先建立连接。每一个ip数据报独立发送，与其前后的分组无关（不进行编号）
    + 网络层不提供服务质量的承诺，即所传送的分组可能出错、丢失、重复和失序，当然也不保证分组传送的时限
+ 网络排错
  + 网线
  + ip地址 子网掩码 网关 dns
  + ping 网关
  + ping 公网地址 8.8.8.8
  + ping www.baidu.com
  + telnet www.baidu.com 80 失败 检查服务器是否开机 web服务是否启动 沿途路由器是否禁止了这个端口
  + 浏览器是否设置了代理
+ ARP协议 
  + 通过广播解析本网段计算机的MAC地址
  + arp -a 查看缓存的MAC地址
  + arp -s 10.7.1.2 00-15-5d-3e-92-08 添加静态的MAC地址
+ IP协议  所有选择路由路径的协议
  + RIP
    + 依据跳数 至多16跳 每隔30s广播自己的路由表
  + OSPF
    + 依据带宽 触发式更新 支持多区域
    + 邻居表 链路状态表
  + EIGRP
  + BGP
+ ICMP协议
  + ping
  + pathping
  + tracert
+ IGMP协议
+ 静态路由
+ 路由汇总 其实就是超网合并子网
  + 默认路由，优先级最低，子网掩码为0.0.0.0
  + route print
  + route add  172.3.2.1 mask 255.255.255.0 10.2.3.4
  + 计算机的默认路由就是网关
+ NAT 会影响路由器性能
+ VPN



IP数据报

|                            |                         |                    |      |            |                          |                         |      |
| -------------------------- | ----------------------- | ------------------ | ---- | ---------- | ------------------------ | ----------------------- | ---- |
| 版本                       | 首部长度                | 区分服务           |      | 总长度     |                          |                         |      |
| ipv4/ipv6?                 | 单位是4B，最小为5       |                    |      | 首部+数据  | 单位是1B                 |                         |      |
| 标识                       |                         |                    |      | 标志       | 片偏移                   |                         |      |
| 同一数据报的分片的标识一致 |                         |                    |      | 只有3bit   | 某分片在原数据报中的位置 | 单位是8B                |      |
| 生存时间 TTL               |                         | 协议               |      | 首部检验和 |                          |                         |      |
| IP分组的保质期             | 经过一个路由器-1，直至0 | 数据部分使用的协议 |      | 只检验首部 |                          |                         |      |
| 源地址                     |                         |                    |      |            |                          |                         |      |
|                            |                         |                    |      |            |                          |                         |      |
| 目的地址                   |                         |                    |      |            |                          |                         |      |
|                            |                         |                    |      |            |                          |                         |      |
| 可选字段                   |                         |                    |      |            |                          | 填充                    |      |
| 长度可变，0-40B            |                         |                    |      |            |                          | 全0，把首部补成4B整数倍 |      |

特殊IP地址

| 网络号 | 主机号            | 作为IP分组源地址 | 作为IP分组目的地址 | 用途                                         |
| ------ | ----------------- | ---------------- | ------------------ | -------------------------------------------- |
| 全0    | 全0               | 可以             |                    | 本网范围内标识主机，路由表中用于表示默认路由 |
| 全0    | 特定值            |                  | 可以               | 表示本网内某个特定主机                       |
| 全1    | 全1               |                  | 可以               | 本网广播地址，路由器不转发                   |
| 特定值 | 全0               |                  |                    | 网络地址，表示一个网络                       |
| 特定值 | 全1               |                  | 可以               | 直接广播地址，对特定网络上的所有主机进行广播 |
| 127    | 任何数（非全0/1） | 可以             | 可以               | 环回地址                                     |

