# 访问共享存储空间中的媒体文件

系统会自动扫描外部存储卷，并将媒体文件添加到以下明确定义的集合中

- **图片**（包括照片和屏幕截图），存储在 `DCIM/` 和 `Pictures/` 目录中。系统将这些文件添加到 [`MediaStore.Images`](https://developer.android.com/reference/android/provider/MediaStore.Images?hl=zh-cn) 表格中
- **视频**，存储在 `DCIM/`、`Movies/` 和 `Pictures/` 目录中。系统将这些文件添加到 [`MediaStore.Video`](https://developer.android.com/reference/android/provider/MediaStore.Video?hl=zh-cn) 表格中
- **音频文件**，存储在 `Alarms/`、`Audiobooks/`、`Music/`、`Notifications/`、`Podcasts/` 和 `Ringtones/` 目录中，以及位于 `Music/` 或 `Movies/` 目录中的音频播放列表中。系统将这些文件添加到 [`MediaStore.Audio`](https://developer.android.com/reference/android/provider/MediaStore.Audio?hl=zh-cn) 表格中
- **下载的文件**，存储在 `Download/` 目录中。在搭载 Android 10（API 级别 29）及更高版本的设备上，这些文件存储在 [`MediaStore.Downloads`](https://developer.android.com/reference/android/provider/MediaStore.Downloads?hl=zh-cn) 表格中。此表格在 Android 9（API 级别 28）及更低版本中不可用

媒体库还包含一个名为 [`MediaStore.Files`](https://developer.android.com/reference/android/provider/MediaStore.Files?hl=zh-cn) 的集合。其内容取决于您的应用是否使用[分区存储](https://developer.android.com/training/data-storage?hl=zh-cn#scoped-storage)（适用于以 Android 10 或更高版本为目标平台的应用）

- 如果启用了分区存储，集合只会显示您的应用创建的照片、视频和音频文件
- 如果分区存储不可用或未使用，集合将显示所有类型的媒体文件

## 请求必要权限

### 存储权限

#### 已启用分区存储

如果您的应用使用分区存储，则应仅针对搭载 Android 9（API 级别 28）或更低版本的设备请求存储相关权限。您可以通过将 `android:maxSdkVersion` 属性添加到应用清单文件中的权限声明来应用此条件

**请勿为搭载 Android 10 或更高版本的设备不必要地请求存储相关权限**。您的应用可以提供明确定义的媒体集合，包括 [`MediaStore.Downloads`](https://developer.android.com/reference/android/provider/MediaStore.Downloads?hl=zh-cn) 集合，而无需请求任何存储相关权限

#### 无法使用分区存储

如果应用在搭载 Android 9 或更低版本的设备上使用，或者应用使用了[存储兼容性功能](https://developer.android.com/training/data-storage/compatibility?hl=zh-cn)，您必须请求 [`READ_EXTERNAL_STORAGE` ](https://developer.android.com/reference/android/Manifest.permission?hl=zh-cn#READ_EXTERNAL_STORAGE)权限才能访问媒体文件。如果要修改媒体文件，您还必须请求 [`WRITE_EXTERNAL_STORAGE`](https://developer.android.com/reference/android/Manifest.permission?hl=zh-cn#WRITE_EXTERNAL_STORAGE) 权限

### 媒体位置权限

如果应用使用[分区存储](https://developer.android.com/training/data-storage?hl=zh-cn#scoped)，您需要在应用的清单中声明 [`ACCESS_MEDIA_LOCATION`](https://developer.android.com/reference/android/Manifest.permission?hl=zh-cn#ACCESS_MEDIA_LOCATION) 权限，然后在运行时请求此权限，应用才能从照片中检索未编辑的 Exif 元数据